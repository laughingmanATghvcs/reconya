{{define "components/network-modal.html"}}
<div class="bg-dark border border-success text-success p-4 rounded" style="max-width: 500px; margin: 0 auto;">
    <!-- Header -->
    <div class="flex justify-between items-center mb-3 pb-2 border-b border-green-600">
        <div class="flex items-center">
            <i class="ti ti-network text-primary mr-3 text-xl"></i>
            <span class="font-bold text-lg">
                {{if .Network.ID}}Edit Network{{else}}Add New Network{{end}}
            </span>
        </div>
        <button type="button" class="text-gray-400 hover:text-white text-lg" onclick="closeModal('networkModal')" aria-label="Close">
            <i class="ti ti-x"></i>
        </button>
    </div>

    <!-- Form -->
    <form {{if .Network.ID}}onsubmit="submitNetworkForm(event, 'PUT', '/api/networks/{{.Network.ID}}')"{{else}}onsubmit="submitNetworkForm(event, 'POST', '/api/networks')"{{end}}>
        
        {{if .Error}}
        <div class="bg-red-600 bg-opacity-10 border border-red-500 rounded p-2 mb-3">
            <i class="ti ti-alert-triangle mr-2 text-red-400"></i>
            <span class="text-red-400">{{.Error}}</span>
        </div>
        {{end}}

        <div class="mb-3">
            <label for="networkName" class="block text-primary text-sm font-bold mb-1">Network Name</label>
            <input type="text" 
                   class="w-full px-3 py-2 bg-zinc-800 border border-green-600 text-gray-200 rounded text-sm" 
                   id="networkName" 
                   name="name"
                   value="{{.Network.Name}}"
                   placeholder="e.g., Home Network, Office LAN">
            <div class="text-gray-400 text-xs mt-1">Optional friendly name</div>
        </div>

        <div class="mb-3">
            <label for="networkCIDR" class="block text-primary text-sm font-bold mb-1">CIDR Address <span class="text-red-400">*</span></label>
            <input type="text" 
                   class="w-full px-3 py-2 bg-zinc-800 border border-green-600 text-gray-200 rounded text-sm" 
                   id="networkCIDR" 
                   name="cidr"
                   value="{{.Network.CIDR}}"
                   placeholder="e.g., 192.168.1.0/24"
                   required>
            <div class="text-gray-400 text-xs mt-1">Network range in CIDR notation</div>
        </div>

        <div class="mb-3">
            <label for="networkDescription" class="block text-primary text-sm font-bold mb-1">Description</label>
            <textarea class="w-full px-3 py-2 bg-zinc-800 border border-green-600 text-gray-200 rounded text-sm resize-y" 
                      id="networkDescription" 
                      name="description"
                      rows="2"
                      placeholder="Optional description...">{{.Network.Description}}</textarea>
        </div>

        {{if not .Network.ID}}
        <div class="bg-blue-600 bg-opacity-10 border border-blue-500 rounded p-2 mb-3">
            <i class="ti ti-info-circle mr-2 text-blue-400"></i>
            <span class="text-blue-400 text-sm">After adding, you can scan this network to discover devices.</span>
        </div>
        {{end}}

        <div class="flex justify-end gap-2 pt-2 border-t border-green-600">
            <button type="button" class="border border-gray-500 text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded text-sm transition-colors" onclick="closeModal('networkModal')">
                <i class="ti ti-x mr-1"></i>Cancel
            </button>
            <button type="submit" class="bg-primary hover:bg-green-600 text-white px-3 py-2 rounded text-sm transition-colors">
                <i class="ti ti-{{if .Network.ID}}edit{{else}}plus{{end}} mr-1"></i>
                {{if .Network.ID}}Update{{else}}Add{{end}}
            </button>
        </div>
    </form>
</div>

<script>
// Form validation
document.getElementById('networkCIDR').addEventListener('input', function() {
    const cidr = this.value.trim();
    const cidrPattern = /^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/;
    
    if (cidr && !cidrPattern.test(cidr)) {
        this.setCustomValidity('Please enter a valid CIDR notation (e.g., 192.168.1.0/24)');
    } else {
        this.setCustomValidity('');
    }
});
</script>
{{end}}